<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>NEXUS — ICT Trading Command Center</title>
  <meta name="description" content="NEXUS: Hệ thống 5 công cụ phân tích trading — COT Dashboard, Daily Bias, Kill Zone Timer, Trade Journal, Performance Hub.">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Space+Mono:wght@400;700&family=Syne:wght@600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="shared/style.css">
  <style>
    /* Hub-specific styles */
    .hub-hero {
      text-align: center;
      padding: 60px 20px 40px;
    }
    .hub-hero .nx-brand { font-size: 13px; }
    .hub-hero .nx-title { font-size: clamp(32px, 5vw, 48px); }
    .hub-hero .nx-subtitle { font-size: 14px; max-width: 520px; margin: 12px auto 0; }

    .hub-tools {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 16px;
      margin: 24px 0 40px;
    }
    .hub-tool-card {
      background: var(--bg-surface);
      border: 1px solid var(--border);
      border-radius: var(--r-lg);
      padding: 28px 24px;
      text-decoration: none;
      color: var(--text-primary);
      transition: border-color 0.2s, transform 0.15s, box-shadow 0.2s;
      display: flex;
      flex-direction: column;
      gap: 12px;
    }
    .hub-tool-card:hover {
      border-color: var(--border-bright);
      transform: translateY(-2px);
      box-shadow: var(--shadow-card);
    }
    .hub-tool-card.active { border-color: var(--accent); }
    .hub-tool-card.disabled {
      opacity: 0.35;
      cursor: not-allowed;
      pointer-events: none;
    }
    .hub-tool-icon {
      width: 40px;
      height: 40px;
      border-radius: var(--r-md);
      display: flex;
      align-items: center;
      justify-content: center;
      background: var(--accent-dim);
      color: var(--accent);
    }
    .hub-tool-icon svg { width: 22px; height: 22px; }
    .hub-tool-title {
      font-family: var(--font-display);
      font-size: 16px;
      font-weight: 700;
    }
    .hub-tool-desc {
      font-size: 13px;
      color: var(--text-secondary);
      line-height: 1.5;
    }
    .hub-tool-tag {
      display: inline-block;
      font-size: 10px;
      letter-spacing: 0.1em;
      text-transform: uppercase;
      font-weight: 700;
      padding: 3px 8px;
      border-radius: var(--r-sm);
    }
    .hub-tool-tag.ready { color: var(--bull); background: var(--bull-dim); }
    .hub-tool-tag.soon  { color: var(--text-muted); background: var(--bg-hover); }

    .hub-status {
      text-align: center;
      padding: 20px;
      margin-bottom: 20px;
    }
    .hub-status-label {
      font-size: 12px;
      color: var(--text-muted);
      letter-spacing: 0.06em;
      margin-bottom: 6px;
    }
    .hub-status-value {
      font-family: var(--font-mono);
      font-size: 14px;
      color: var(--text-secondary);
    }
    .hub-status-value .fresh { color: var(--bull); }
    .hub-status-value .stale { color: var(--warn); }
  </style>
</head>
<body>
<div class="nx-app">
  <div class="nx-main">
    <div class="nx-content">

      <!-- Hero -->
      <div class="hub-hero">
        <div class="nx-brand">ICT TRADER TOOLS</div>
        <h1 class="nx-title"><span class="hl">NEXUS</span></h1>
        <p class="nx-subtitle">ICT Trading Command Center — 5 công cụ phân tích kết nối thành một hệ thống giao dịch hoàn chỉnh.</p>
      </div>

      <!-- Data Status -->
      <div class="hub-status" id="dataStatus">
        <div class="hub-status-label">DỮ LIỆU CFTC</div>
        <div class="hub-status-value" id="dataStatusValue">Đang kiểm tra...</div>
      </div>

      <!-- Tool Cards -->
      <div class="hub-tools">
        <a href="cot/index.html" class="hub-tool-card active" id="cotCard">
          <div class="hub-tool-icon"></div>
          <div class="hub-tool-title">COT Dashboard</div>
          <div class="hub-tool-desc">COT Index 52 tuần, Matrix 8 cặp tiền, Ranking, Pair Strength Grid, Signals tự động.</div>
          <span class="hub-tool-tag ready">HOẠT ĐỘNG</span>
        </a>

        <div class="hub-tool-card disabled">
          <div class="hub-tool-icon"></div>
          <div class="hub-tool-title">Daily Bias Board</div>
          <div class="hub-tool-desc">Tổng hợp COT bias + Lãi suất + News để xác định hướng giao dịch hàng ngày.</div>
          <span class="hub-tool-tag soon">SẮP RA MẮT</span>
        </div>

        <div class="hub-tool-card disabled">
          <div class="hub-tool-icon"></div>
          <div class="hub-tool-title">Kill Zone Timer</div>
          <div class="hub-tool-desc">Đồng hồ Kill Zone real-time, Timeline tin tức, Smart Recommendation.</div>
          <span class="hub-tool-tag soon">SẮP RA MẮT</span>
        </div>

        <a href="journal/index.html" class="hub-tool-card active">
          <div class="hub-tool-icon"></div>
          <div class="hub-tool-title">Trade Journal</div>
          <div class="hub-tool-desc">Nhật ký giao dịch tự động ghi nhận context từ COT + Daily Bias.</div>
          <span class="hub-tool-tag ready">HOẠT ĐỘNG</span>
        </a>

        <div class="hub-tool-card disabled">
          <div class="hub-tool-icon"></div>
          <div class="hub-tool-title">Performance Hub</div>
          <div class="hub-tool-desc">Phân tích Win Rate, RR, Expectancy. Breakdown theo pair, session, setup.</div>
          <span class="hub-tool-tag soon">SẮP RA MẮT</span>
        </div>
      </div>

      <!-- Footer -->
      <footer class="nx-footer">
        Nguồn dữ liệu: CFTC.gov · Cập nhật mỗi thứ Sáu<br>
        NEXUS — ICT Trading Command Center · v1.0
      </footer>

    </div>
  </div>
</div>

<script src="shared/utils.js"></script>
<script src="shared/store.js"></script>
<script src="shared/crypto.js"></script>
<script src="shared/sync.js"></script>
<script src="shared/nav.js"></script>
<script>
  // Inject icons into tool cards
  const cardIcons = [SVG_ICONS.barChart, SVG_ICONS.compass, SVG_ICONS.clock, SVG_ICONS.bookOpen, SVG_ICONS.trendingUp];
  document.querySelectorAll('.hub-tool-icon').forEach((el, i) => {
    if (cardIcons[i]) el.innerHTML = cardIcons[i];
  });

  // Check data freshness
  (function checkData() {
    const el = document.getElementById('dataStatusValue');
    const cached = Store.get(Store.KEYS.MATRIX_CACHE);
    if (cached && cached.timestamp) {
      const d = new Date(cached.timestamp);
      const age = (Date.now() - d.getTime()) / (1000 * 60 * 60);
      if (age < 168) { // < 7 days
        el.innerHTML = `<span class="fresh">●</span> Tuần ${cached.weekLabel || '?'} — cập nhật ${d.toLocaleDateString('vi-VN')} lúc ${d.toLocaleTimeString('vi-VN', {hour:'2-digit',minute:'2-digit'})}`;
      } else {
        el.innerHTML = `<span class="stale">●</span> Dữ liệu cũ (${Math.floor(age/24)} ngày trước) — Cần cập nhật`;
      }
    } else {
      // Try fetching cot-latest.json
      fetch('data/cot-latest.json').then(r => r.json()).then(data => {
        if (data && data.meta) {
          const d = new Date(data.meta.fetchedAt);
          el.innerHTML = `<span class="fresh">●</span> ${data.meta.weekLabel} — ${d.toLocaleDateString('vi-VN')}`;
        } else {
          el.textContent = 'Chưa có dữ liệu. Vào COT Dashboard để tải.';
        }
      }).catch(() => {
        el.textContent = 'Chưa có dữ liệu. Vào COT Dashboard để tải.';
      });
    }
  })();
</script>
</body>
</html>
